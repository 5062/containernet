experiments:
  - repetitions: 1
    name: "apache2-ab"
    target_ip: "192.168.10.4"
    maxinet:
      hostnamemapping:
        fgcn-of-1: 0
        fgcn-of-2: 1
        fgcn-of-3: 2
        fgcn-of-4: 3
      nodemapping:
        vm1: 3
        vm2: 2
        s1: 3
        s2: 2
    nodes:
      vm1:
        cpu_cores:
          - 1
          - 2
          - 3
        mem:
          - 1024
        maxinet:
          type: "LibvirtHost"
          disk_image: "/srv/images/ubuntu16.04.qcow2"
          ip: "192.168.10.4/24"
        containernet:
          type: "LibvirtHost"
          disk_image: "/srv/images/ubuntu16.04.qcow2"
          ip: "192.168.10.4/24"
        local:
          run_on: "fgcn-of-4"
          systemd_type: "forking"
          setup:
            args: "/usr/sbin/apache2ctl start"
      vm2:
        run_on: "fgcn-of-3"
        ip: "192.168.10.8/24"
        start:
          args: "/usr/bin/nohup /usr/bin/ab -s 1 -n 1000 -e {outfile} {target_ip}/ > /dev/null &"
          waitpid: True
    links:
      - from: vm1
        to: s1
        params:
          bw: 100
          loss: 0
      - from: s2
        to: vm2
        params:
          bw: 100
          loss: 0
      - from: s1
        to: s2
    switches:
      - s1
      - s2