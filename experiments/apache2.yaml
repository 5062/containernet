experiments:
  - repetitions: 1
    name: "apache2-ab"
    target_ip: "192.168.10.4"
    maxinet:
      hostnamemapping:
        fgcn-of-1: 0
        fgcn-of-2: 1
        fgcn-of-3: 2
        fgcn-of-4: 3
      nodemapping:
        vm1: 3
        vm2: 2
        vm3: 1
        s1: 3
        s2: 2
        s3: 1
    nodes:
      vm1:
        cpu_cores:
          - 1
          - 2
          - 3
        mem:
          - 1024
        maxinet:
          type: "LibvirtHost"
          disk_image: "/srv/images/ubuntu16.04.qcow2"
          ip: "192.168.10.4/24"
        containernet:
          type: "LibvirtHost"
          disk_image: "/srv/images/ubuntu16.04.qcow2"
          ip: "192.168.10.4/24"
        local:
          run_on: "fgcn-of-4"
          systemd_type: "forking"
          setup:
            args: "/usr/sbin/apache2ctl start"
      vm2:
        run_on: "fgcn-of-3"
        ip: "192.168.10.8/24"
        start:
          args: "/usr/bin/nohup /usr/bin/ab -s 1 -n 10000 -e {outfile} {target_ip}/ > /dev/null &"
          waitpid: True
      vm3:
        run_on: "fgcn-of-2"
        ip: "192.168.10.5/24"
    links:
      - from: "vm1"
        to: "s1"
      - from: "vm2"
        to: "s2"
      - from: "vm3"
        to: "s3"
      - from: "s1"
        to: "s2"
      - from: "s2"
        to: "s3"
    switches:
      - "s1"
      - "s2"
      - "s3"